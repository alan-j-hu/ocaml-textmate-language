<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>TmLanguage (textmate-language.TmLanguage)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">textmate-language</a> &#x00BB; TmLanguage</nav><header class="odoc-preamble"><h1>Module <code><span>TmLanguage</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>The collection of TextMate grammars.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-grammar" class="anchored"><a href="#type-grammar" class="anchor"></a><code><span><span class="keyword">type</span> grammar</span></code></div><div class="spec-doc"><p>A TextMate grammar.</p></div></div><div class="odoc-spec"><div class="spec exception" id="exception-Error" class="anchored"><a href="#exception-Error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Error</span> <span class="keyword">of</span> string</span></code></div><div class="spec-doc"><p>The error message is purely informational and is not to be matched on.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-plist" class="anchored"><a href="#type-plist" class="anchor"></a><code><span><span class="keyword">type</span> plist</span><span> = </span><span>[ </span></code><table><tr id="type-plist.Bool" class="anchored"><td class="def constructor"><a href="#type-plist.Bool" class="anchor"></a><code><span>| </span></code><code><span>`Bool <span class="keyword">of</span> bool</span></code></td></tr><tr id="type-plist.Data" class="anchored"><td class="def constructor"><a href="#type-plist.Data" class="anchor"></a><code><span>| </span></code><code><span>`Data <span class="keyword">of</span> string</span></code></td></tr><tr id="type-plist.Date" class="anchored"><td class="def constructor"><a href="#type-plist.Date" class="anchor"></a><code><span>| </span></code><code><span>`Date <span class="keyword">of</span> float * <span>float option</span></span></code></td></tr><tr id="type-plist.Float" class="anchored"><td class="def constructor"><a href="#type-plist.Float" class="anchor"></a><code><span>| </span></code><code><span>`Float <span class="keyword">of</span> float</span></code></td></tr><tr id="type-plist.Int" class="anchored"><td class="def constructor"><a href="#type-plist.Int" class="anchor"></a><code><span>| </span></code><code><span>`Int <span class="keyword">of</span> int</span></code></td></tr><tr id="type-plist.String" class="anchored"><td class="def constructor"><a href="#type-plist.String" class="anchor"></a><code><span>| </span></code><code><span>`String <span class="keyword">of</span> string</span></code></td></tr><tr id="type-plist.Array" class="anchored"><td class="def constructor"><a href="#type-plist.Array" class="anchor"></a><code><span>| </span></code><code><span>`Array <span class="keyword">of</span> <span><a href="#type-plist">plist</a> list</span></span></code></td></tr><tr id="type-plist.Dict" class="anchored"><td class="def constructor"><a href="#type-plist.Dict" class="anchor"></a><code><span>| </span></code><code><span>`Dict <span class="keyword">of</span> <span><span>(string * <a href="#type-plist">plist</a>)</span> list</span></span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>A plist document. This is the same type as <code>t</code> defined in the <a href="https://opam.ocaml.org/packages/plist-xml/"><code>plist-xml</code></a> package (as of version 0.3.0), but is reproduced here as not to depend on <code>plist-xml</code>.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-ezjsonm" class="anchored"><a href="#type-ezjsonm" class="anchor"></a><code><span><span class="keyword">type</span> ezjsonm</span><span> = </span><span>[ </span></code><table><tr id="type-ezjsonm.Null" class="anchored"><td class="def constructor"><a href="#type-ezjsonm.Null" class="anchor"></a><code><span>| </span></code><code><span>`Null</span></code></td></tr><tr id="type-ezjsonm.Bool" class="anchored"><td class="def constructor"><a href="#type-ezjsonm.Bool" class="anchor"></a><code><span>| </span></code><code><span>`Bool <span class="keyword">of</span> bool</span></code></td></tr><tr id="type-ezjsonm.Float" class="anchored"><td class="def constructor"><a href="#type-ezjsonm.Float" class="anchor"></a><code><span>| </span></code><code><span>`Float <span class="keyword">of</span> float</span></code></td></tr><tr id="type-ezjsonm.String" class="anchored"><td class="def constructor"><a href="#type-ezjsonm.String" class="anchor"></a><code><span>| </span></code><code><span>`String <span class="keyword">of</span> string</span></code></td></tr><tr id="type-ezjsonm.A" class="anchored"><td class="def constructor"><a href="#type-ezjsonm.A" class="anchor"></a><code><span>| </span></code><code><span>`A <span class="keyword">of</span> <span><a href="#type-ezjsonm">ezjsonm</a> list</span></span></code></td></tr><tr id="type-ezjsonm.O" class="anchored"><td class="def constructor"><a href="#type-ezjsonm.O" class="anchor"></a><code><span>| </span></code><code><span>`O <span class="keyword">of</span> <span><span>(string * <a href="#type-ezjsonm">ezjsonm</a>)</span> list</span></span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>A JSON document. This is the same type as <code>value</code> defined in the <a href="https://opam.ocaml.org/packages/ezjsonm/"><code>ezjsonm</code></a> package (as of version 1.2.0), but is reproduced here as not to depend on <code>ezjsonm</code>.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-yojson" class="anchored"><a href="#type-yojson" class="anchor"></a><code><span><span class="keyword">type</span> yojson</span><span> = </span><span>[ </span></code><table><tr id="type-yojson.Null" class="anchored"><td class="def constructor"><a href="#type-yojson.Null" class="anchor"></a><code><span>| </span></code><code><span>`Null</span></code></td></tr><tr id="type-yojson.Bool" class="anchored"><td class="def constructor"><a href="#type-yojson.Bool" class="anchor"></a><code><span>| </span></code><code><span>`Bool <span class="keyword">of</span> bool</span></code></td></tr><tr id="type-yojson.Int" class="anchored"><td class="def constructor"><a href="#type-yojson.Int" class="anchor"></a><code><span>| </span></code><code><span>`Int <span class="keyword">of</span> int</span></code></td></tr><tr id="type-yojson.Float" class="anchored"><td class="def constructor"><a href="#type-yojson.Float" class="anchor"></a><code><span>| </span></code><code><span>`Float <span class="keyword">of</span> float</span></code></td></tr><tr id="type-yojson.String" class="anchored"><td class="def constructor"><a href="#type-yojson.String" class="anchor"></a><code><span>| </span></code><code><span>`String <span class="keyword">of</span> string</span></code></td></tr><tr id="type-yojson.Assoc" class="anchored"><td class="def constructor"><a href="#type-yojson.Assoc" class="anchor"></a><code><span>| </span></code><code><span>`Assoc <span class="keyword">of</span> <span><span>(string * <a href="#type-yojson">yojson</a>)</span> list</span></span></code></td></tr><tr id="type-yojson.List" class="anchored"><td class="def constructor"><a href="#type-yojson.List" class="anchor"></a><code><span>| </span></code><code><span>`List <span class="keyword">of</span> <span><a href="#type-yojson">yojson</a> list</span></span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>A JSON document. This is the same type as <code>Basic.t</code> defined in the <a href="https://opam.ocaml.org/packages/yojson/"><code>yojson</code></a> package (as of version 1.7.0), but is reproduced here as not to depend on <code>yojson</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Creates an empty collection of grammars.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-add_grammar" class="anchored"><a href="#val-add_grammar" class="anchor"></a><code><span><span class="keyword">val</span> add_grammar : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grammar">grammar</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Adds a grammar to the collection.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-find_by_name" class="anchored"><a href="#val-find_by_name" class="anchor"></a><code><span><span class="keyword">val</span> find_by_name : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grammar">grammar</a> option</span></span></code></div><div class="spec-doc"><p>Finds a grammar by its <code>name</code> attribute. Case-insensitive.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-find_by_scope_name" class="anchored"><a href="#val-find_by_scope_name" class="anchor"></a><code><span><span class="keyword">val</span> find_by_scope_name : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grammar">grammar</a> option</span></span></code></div><div class="spec-doc"><p>Finds a grammar by its <code>scopeName</code> attribute. Case-sensitive.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-find_by_filetype" class="anchored"><a href="#val-find_by_filetype" class="anchor"></a><code><span><span class="keyword">val</span> find_by_filetype : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grammar">grammar</a> option</span></span></code></div><div class="spec-doc"><p>Finds a grammar by matching one of the strings in its <code>fileTypes</code> attribute. Case-sensitive.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_plist_exn" class="anchored"><a href="#val-of_plist_exn" class="anchor"></a><code><span><span class="keyword">val</span> of_plist_exn : <span><a href="#type-plist">plist</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-grammar">grammar</a></span></code></div><div class="spec-doc"><p>Reads a TextMate grammar from a PLIST file. Raises <a href="#exception-Error"><code>Error</code></a> if the plist does not represent a valid TextMate grammar.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_ezjsonm_exn" class="anchored"><a href="#val-of_ezjsonm_exn" class="anchor"></a><code><span><span class="keyword">val</span> of_ezjsonm_exn : <span><a href="#type-ezjsonm">ezjsonm</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-grammar">grammar</a></span></code></div><div class="spec-doc"><p>Reads a TextMate grammar from a JSON file. Raises <a href="#exception-Error"><code>Error</code></a> if the plist does not represent a valid TextMate grammar.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_yojson_exn" class="anchored"><a href="#val-of_yojson_exn" class="anchor"></a><code><span><span class="keyword">val</span> of_yojson_exn : <span><a href="#type-yojson">yojson</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-grammar">grammar</a></span></code></div><div class="spec-doc"><p>Reads a TextMate grammar from a JSON file. Raises <a href="#exception-Error"><code>Error</code></a> if the plist does not represent a valid TextMate grammar.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-stack" class="anchored"><a href="#type-stack" class="anchor"></a><code><span><span class="keyword">type</span> stack</span></code></div><div class="spec-doc"><p>The state of the tokenizer.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-empty" class="anchored"><a href="#val-empty" class="anchor"></a><code><span><span class="keyword">val</span> empty : <a href="#type-stack">stack</a></span></code></div><div class="spec-doc"><p>The initial state of the tokenizer.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-token" class="anchored"><a href="#type-token" class="anchor"></a><code><span><span class="keyword">type</span> token</span></code></div><div class="spec-doc"><p>A token of code.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ending" class="anchored"><a href="#val-ending" class="anchor"></a><code><span><span class="keyword">val</span> ending : <span><a href="#type-token">token</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>One past the index of the last character of the token.</p><p>If <code>tok</code> is the first token of the line, <code>tok</code> spans the substring within interval [<code>0</code>, <code>ending tok</code>). If <code>tok</code> succeeds a token <code>prev</code>, <code>tok</code> spans the substring within interval [<code>ending prev</code>, <code>ending tok</code>).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-scopes" class="anchored"><a href="#val-scopes" class="anchor"></a><code><span><span class="keyword">val</span> scopes : <span><a href="#type-token">token</a> <span class="arrow">&#45;&gt;</span></span> <span>string list</span></span></code></div><div class="spec-doc"><p>The token's stack of TextMate grammar scopes.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-tokenize_exn" class="anchored"><a href="#val-tokenize_exn" class="anchor"></a><code><span><span class="keyword">val</span> tokenize_exn : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-grammar">grammar</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-stack">stack</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-token">token</a> list</span> * <a href="#type-stack">stack</a></span></code></div><div class="spec-doc"><p>Usage: <code>let tokens, stack = tokenize_exn t grammar stack line</code></p><p>Tokenizes a line of code. Returns the list of tokens <code>tokens</code> and the updated tokenization state <code>stack</code>.</p><p>Precondition:</p><ul><li><code>line</code> must be a single line, including the newline character at the end.</li></ul><p>Postconditions:</p><ul><li><code>tokens</code> is nonempty.</li><li>The ending positions of <code>tokens</code> are strictly increasing.</li><li>The <code>ending</code> of the last token in <code>tokens</code> is always <code>String.length line</code>.</li></ul><p>Raises <a href="#exception-Error"><code>Error</code></a> if it tries to match a malformed <code>end</code> or <code>while</code> regex.</p><p>Raises <a href="#exception-Error"><code>Error</code></a> if it tries to access a local repository that doesn't exist in the file. Currently, it silently ignores <code>include</code>s of other grammars that don't exist in <code>t</code>.</p></div></div></div></body></html>